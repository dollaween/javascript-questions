# Javascript-вопросы: Оптимизация

##### 1. У нас есть большая макрозадача по перебору 1e9 элементов таблицы. С какими трудностями можно столкнуться и как их решить?
```js
let i = 0

const fn = () => {
  for (let k = 0; k < 1e9; k++) {
    i++
  }
  console.log('finish!')
}

fn()
```
<details><summary><b>Ответ</b></summary>
<p>

Пока движок занят перебором элементов, он не может делать ничего связанного с DOM, не может обрабатывать пользовательские события и т.д.

Для оптимизации такой задачи её можно разбить на несколько задач. Теперь, если новая сторонняя задача появляется (например, событие `onclick`), пока движок занят выполнением частью задачи, то она становится в очередь и будет выполнена, когда часть задачи будет завершена.

```js
let i = 0

const fn = () => {
  if (i < 1e9 - 1e6) {
    setTimeout(fn)
  }

  do {
    i++
  } while (i % 1e6 != 0)

  if (i == 1e9) {
    console.log('finish!')
  }
}

fn()
```

</p>
</details>
